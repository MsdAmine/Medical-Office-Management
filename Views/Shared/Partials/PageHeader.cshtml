@model MedicalOfficeManagement.ViewModels.UI.PageHeaderModel
@using System.Collections.Generic

<div class="page-header">
    <div class="space-y-2">
        <div class="flex items-center gap-2 flex-wrap">
            @if (!string.IsNullOrEmpty(Model.ContextTag))
            {
                <span class="badge info">@Model.ContextTag</span>
            }
            @{
                var breadcrumbs = Model.Breadcrumbs?.ToList() ?? new List<BreadcrumbItem>();
            }
            @if (breadcrumbs.Any())
            {
                <nav aria-label="Breadcrumb" class="text-xs text-slate-500 flex items-center gap-1">
                    @for (var i = 0; i < breadcrumbs.Count; i++)
                    {
                        var crumb = breadcrumbs[i];
                        if (!string.IsNullOrEmpty(crumb.Url) && !crumb.Current)
                        {
                            <a href="@crumb.Url" class="text-slate-600 hover:text-brand-700 font-semibold">@crumb.Label</a>
                        }
                        else
                        {
                            <span class="font-semibold text-slate-900">@crumb.Label</span>
                        }
                        if (i < breadcrumbs.Count - 1)
                        {
                            <span aria-hidden="true" class="text-slate-400">/</span>
                        }
                    }
                </nav>
            }
        </div>
        <div class="space-y-1">
            <h1>@Model.Title</h1>
            @if (!string.IsNullOrEmpty(Model.Subtitle))
            {
                <p class="text-sm">@Model.Subtitle</p>
            }
            @if (!string.IsNullOrEmpty(Model.Meta))
            {
                <p class="text-xs text-slate-500">@Model.Meta</p>
            }
        </div>
    </div>
    <div class="flex items-center gap-3 flex-wrap justify-end">
        @if (!string.IsNullOrEmpty(Model.RoleBadge))
        {
            var tone = string.IsNullOrEmpty(Model.RoleTone) ? "info" : Model.RoleTone;
            <span class="badge @tone">@Model.RoleBadge</span>
        }
        @if (Model.Actions?.Any() == true)
        {
            @foreach (var action in Model.Actions)
            {
                var styleClass = action.Style switch
                {
                    "secondary" => "btn btn-secondary",
                    "ghost" => "btn btn-ghost",
                    "quiet" => "btn btn-quiet",
                    _ => "btn btn-primary"
                };
                var iconClass = action.Icon ?? "";
                if (!string.IsNullOrEmpty(action.Href) && !action.IsButton)
                {
                    <a href="@action.Href"
                       class="@styleClass"
                       title="@action.Tooltip"
                       @(action.Disabled ? "aria-disabled=\"true\"" : "")
                       @(action.Disabled ? "tabindex=\"-1\"" : "")>
                        @if (!string.IsNullOrEmpty(iconClass))
                        {
                            <span class="iconify w-4 h-4" data-icon="@iconClass"></span>
                        }
                        @action.Label
                    </a>
                }
                else
                {
                    <button type="button"
                            class="@styleClass"
                            title="@action.Tooltip"
                            @(action.Disabled ? "disabled aria-disabled=\"true\"" : "")
                            @(string.IsNullOrEmpty(action.DataTarget) ? "" : $"data-target=\"{action.DataTarget}\"")>
                        @if (!string.IsNullOrEmpty(iconClass))
                        {
                            <span class="iconify w-4 h-4" data-icon="@iconClass"></span>
                        }
                        @action.Label
                    </button>
                }
            }
        }
    </div>
</div>
